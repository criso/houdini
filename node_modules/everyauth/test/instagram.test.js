// TODO This needs *. cookie support

var tobi = require('tobi')
  , should = require('should')
  , browser = tobi.createBrowser(3000, 'local.host')
  , creds = require('./creds.js');

// Test a successful login
browser.userAgent = 'Mozilla/5.0 (X11; Linux i686) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.100 Safari/534.30';
browser.get('/auth/instagram', function (res, $) {
  console.log("~");
  return;
  // Login
  $('form')
    .fill({ 
        username: creds.instagram.login
      , password: creds.instagram.password
    }).submit(function (res, $) {
      console.log("!");
      res.should.have.status(200);

      // Authorize the app
      $('form').submit( function (res, $) {
        console.log("!!");
        res.should.have.status(200);
        $('h2').should.have.text('Authenticated');
        $('h2').should.not.have.text('Not Authenticated');
      });
    }, '.confirm');
});
